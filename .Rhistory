col = 'blue')
text(fpr4, recall4, labels = c(0, 3, 6, 9), pos = 3)
legend('topleft', bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(fpr, recall, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], recall[order(recall, decreasing = TRUE)])
points(fpr2, recall2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], recall2[order(recall2, decreasing = TRUE)],
col = 'red')
points(fpr3, recall3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], recall3[order(recall3, decreasing = TRUE)],
col = 'green')
points(fpr4, recall4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], recall4[order(recall4, decreasing = TRUE)],
col = 'blue')
text(fpr4, recall4, labels = c(0, 3, 6, 9), pos = 3)
legend('bottomright', bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(fpr, recall, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], recall[order(recall, decreasing = TRUE)])
points(fpr2, recall2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], recall2[order(recall2, decreasing = TRUE)],
col = 'red')
points(fpr3, recall3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], recall3[order(recall3, decreasing = TRUE)],
col = 'green')
points(fpr4, recall4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], recall4[order(recall4, decreasing = TRUE)],
col = 'blue')
text(fpr4, recall4, labels = c(0, 3, 6, 9), pos = 3)
legend('bottomleft', bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(fpr, recall, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], recall[order(recall, decreasing = TRUE)])
points(fpr2, recall2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], recall2[order(recall2, decreasing = TRUE)],
col = 'red')
points(fpr3, recall3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], recall3[order(recall3, decreasing = TRUE)],
col = 'green')
points(fpr4, recall4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], recall4[order(recall4, decreasing = TRUE)],
col = 'blue')
text(fpr4, recall4, labels = c(0, 3, 6, 9), pos = 3)
legend('bottomcenter', bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(fpr, recall, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], recall[order(recall, decreasing = TRUE)])
points(fpr2, recall2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], recall2[order(recall2, decreasing = TRUE)],
col = 'red')
points(fpr3, recall3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], recall3[order(recall3, decreasing = TRUE)],
col = 'green')
points(fpr4, recall4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], recall4[order(recall4, decreasing = TRUE)],
col = 'blue')
text(fpr4, recall4, labels = c(0, 3, 6, 9), pos = 3)
legend('right', bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(fpr, recall, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], recall[order(recall, decreasing = TRUE)])
points(fpr2, recall2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], recall2[order(recall2, decreasing = TRUE)],
col = 'red')
points(fpr3, recall3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], recall3[order(recall3, decreasing = TRUE)],
col = 'green')
points(fpr4, recall4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], recall4[order(recall4, decreasing = TRUE)],
col = 'blue')
text(fpr4, recall4, labels = c(0, 3, 6, 9), pos = 3)
legend('topright', bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(fpr, recall, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], recall[order(recall, decreasing = TRUE)])
points(fpr2, recall2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], recall2[order(recall2, decreasing = TRUE)],
col = 'red')
points(fpr3, recall3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], recall3[order(recall3, decreasing = TRUE)],
col = 'green')
points(fpr4, recall4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], recall4[order(recall4, decreasing = TRUE)],
col = 'blue')
text(fpr4, recall4, labels = c(0, 3, 6, 9), pos = 3)
legend(0.05, 0.1, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(fpr, recall, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], recall[order(recall, decreasing = TRUE)])
points(fpr2, recall2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], recall2[order(recall2, decreasing = TRUE)],
col = 'red')
points(fpr3, recall3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], recall3[order(recall3, decreasing = TRUE)],
col = 'green')
points(fpr4, recall4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], recall4[order(recall4, decreasing = TRUE)],
col = 'blue')
text(fpr4, recall4, labels = c(0, 3, 6, 9), pos = 3)
legend(0.04, 0.1, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(recall, precision, asp = 1, ylab = 'precision',
xlab = 'recall', main = 'Precision-Recall (non-personalized)', bty = 'l')
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(recall[order(recall, decreasing = TRUE)],
precision[order(precision, decreasing = TRUE)])
lines(recall[order(recall)],
precision[order(precision)])
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(recall[order(recall)],
precision[order(precision)])
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(recall[order(recall)],
precision[order(precision, decreasing = true)])
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(recall[order(recall)],
precision[order(precision, decreasing = TRUE)])
precision <- sapply(pred[10:12], mean)
tpr <- c(0, mean(unlist(recall_means3)), mean(unlist(recall_means6)),
mean(unlist(recall_means9)))
recall <- c(mean(unlist(recall_means3)), mean(unlist(recall_means6)),
mean(unlist(recall_means9)))
precision2 <- sapply(pred2[10:12], mean)
recall2 <- c(mean(unlist(recall2_means3)), mean(unlist(recall2_means6)),
mean(unlist(recall2_means9)))
tpr2 <- c(0, mean(unlist(recall2_means3)), mean(unlist(recall2_means6)),
mean(unlist(recall2_means9)))
precision3 <- sapply(pred3[10:12], mean)
recall3 <- c(mean(unlist(recall3_means3)), mean(unlist(recall3_means6)),
mean(unlist(recall3_means9)))
tpr3 <- c(0, mean(unlist(recall3_means3)), mean(unlist(recall3_means6)),
mean(unlist(recall3_means9)))
precision4 <- sapply(pred4[10:12], mean)
recall4 <- c(mean(unlist(recall4_means3)), mean(unlist(recall4_means6)),
mean(unlist(recall4_means9)))
tpr4 <- c(0, mean(unlist(recall4_means3)), mean(unlist(recall4_means6)),
mean(unlist(recall4_means9)))
plot(fpr, tpr, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], tpr[order(tpr, decreasing = TRUE)])
points(fpr2, tpr2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], tpr2[order(tpr2, decreasing = TRUE)],
col = 'red')
points(fpr3, tpr3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], tpr3[order(tpr3, decreasing = TRUE)],
col = 'green')
points(fpr4, tpr4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], tpr4[order(tpr4, decreasing = TRUE)],
col = 'blue')
text(fpr4, tpr4, labels = c(0, 3, 6, 9), pos = 3)
legend(0.04, 0.1, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(16, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(fpr, tpr, ylim = c(0, 0.18), xlim = c(0, 0.07), asp = 1, ylab = 'TPR',
xlab = 'FPR', main = 'ROC Curve (non-personalized)', bty = 'l')
lines(fpr[order(fpr, decreasing = TRUE)], tpr[order(tpr, decreasing = TRUE)])
points(fpr2, tpr2, col = 'red', pch = 2)
lines(fpr2[order(fpr2, decreasing = TRUE)], tpr2[order(tpr2, decreasing = TRUE)],
col = 'red')
points(fpr3, tpr3, col = 'green', pch = '+')
lines(fpr3[order(fpr3, decreasing = TRUE)], tpr3[order(tpr3, decreasing = TRUE)],
col = 'green')
points(fpr4, tpr4, col = 'blue', pch = 'x')
lines(fpr4[order(fpr4, decreasing = TRUE)], tpr4[order(tpr4, decreasing = TRUE)],
col = 'blue')
text(fpr4, tpr4, labels = c(0, 3, 6, 9), pos = 3)
legend(0.04, 0.1, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(1:4), col = c('black', 'red', 'green', 'blue'))
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(recall[order(recall)],
precision[order(precision, decreasing = TRUE)])
points(recall2, precision2, col = 'red', pch = 2)
lines(recall2[order(recall2)], precision2[order(precision2, decreasing = TRUE)],
col = 'red')
points(recall3, precision3, col = 'green', pch = '+')
points(recall4, precision4, col = 'blue', pch = 'x')
lines(recall4[order(recall4)], precision4[order(precision4, decreasing = TRUE)],
col = 'blue')
lines(recall3[order(recall3)], precision3[order(precision3, decreasing = TRUE)],
col = 'green')
text(recall4, precision4, labels = c(0, 3, 6, 9), pos = 3)
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(recall[order(recall)], precision[order(precision, decreasing = TRUE)])
points(recall2, precision2, col = 'red', pch = 2)
lines(recall2[order(recall2)], precision2[order(precision2, decreasing = TRUE)],
col = 'red')
points(recall3, precision3, col = 'green', pch = '+')
lines(recall3[order(recall3)], precision3[order(precision3, decreasing = TRUE)],
col = 'green')
points(recall4, precision4, col = 'blue', pch = 'x')
lines(recall4[order(recall4)], precision4[order(precision4, decreasing = TRUE)],
col = 'blue')
text(recall4, precision4, labels = c(3, 6, 9), pos = 3)
legend(0, 0.05, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(1, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(recall[order(recall)], precision[order(precision, decreasing = TRUE)])
points(recall2, precision2, col = 'red', pch = 2)
lines(recall2[order(recall2)], precision2[order(precision2, decreasing = TRUE)],
col = 'red')
points(recall3, precision3, col = 'green', pch = '+')
lines(recall3[order(recall3)], precision3[order(precision3, decreasing = TRUE)],
col = 'green')
points(recall4, precision4, col = 'blue', pch = 'x')
lines(recall4[order(recall4)], precision4[order(precision4, decreasing = TRUE)],
col = 'blue')
text(recall4, precision4, labels = c(3, 6, 9), pos = 3)
legend(0, 0.075, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(1, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(c(0, recall[order(recall)]), c(0, precision[order(precision, decreasing = TRUE)]))
precision <- c(0, sapply(pred[10:12], mean))
recall <- c(0, mean(unlist(recall_means3)), mean(unlist(recall_means6)),
mean(unlist(recall_means9)))
tpr <- recall
precision2 <- c(0, sapply(pred2[10:12], mean))
recall2 <- c(0, mean(unlist(recall2_means3)), mean(unlist(recall2_means6)),
mean(unlist(recall2_means9)))
tpr2 <- recall2
precision3 <- c(0, sapply(pred3[10:12], mean))
recall3 <- c(0, mean(unlist(recall3_means3)), mean(unlist(recall3_means6)),
mean(unlist(recall3_means9)))
tpr3 <- recall3
precision4 <- c(0, sapply(pred4[10:12], mean))
recall4 <- c(0, mean(unlist(recall4_means3)), mean(unlist(recall4_means6)),
mean(unlist(recall4_means9)))
tpr4 <- recall4
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(c(0, recall[order(recall)]), c(0, precision[order(precision, decreasing = TRUE)]))
precision <- sapply(pred[10:12], mean)
tpr <- c(0, mean(unlist(recall_means3)), mean(unlist(recall_means6)),
mean(unlist(recall_means9)))
recall <- c(mean(unlist(recall_means3)), mean(unlist(recall_means6)),
mean(unlist(recall_means9)))
precision2 <- sapply(pred2[10:12], mean)
recall2 <- c(mean(unlist(recall2_means3)), mean(unlist(recall2_means6)),
mean(unlist(recall2_means9)))
tpr2 <- c(0, mean(unlist(recall2_means3)), mean(unlist(recall2_means6)),
mean(unlist(recall2_means9)))
precision3 <- sapply(pred3[10:12], mean)
recall3 <- c(mean(unlist(recall3_means3)), mean(unlist(recall3_means6)),
mean(unlist(recall3_means9)))
tpr3 <- c(0, mean(unlist(recall3_means3)), mean(unlist(recall3_means6)),
mean(unlist(recall3_means9)))
precision4 <- sapply(pred4[10:12], mean)
recall4 <- c(mean(unlist(recall4_means3)), mean(unlist(recall4_means6)),
mean(unlist(recall4_means9)))
tpr4 <- c(0, mean(unlist(recall4_means3)), mean(unlist(recall4_means6)),
mean(unlist(recall4_means9)))
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
plot(0, 0)
plot(0, 0, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
points(recall, precision)
lines(c(0, recall[order(recall)]), c(0, precision[order(precision, decreasing = TRUE)]))
points(0, 0, col = 'red', pch = 2)
points(recall2, precision2, col = 'red', pch = 2)
lines(c(0, recall2[order(recall2)]),
c(0, precision2[order(precision2, decreasing = TRUE)]), col = 'red')
points(0, 0, col = 'green', pch = '+')
points(recall3, precision3, col = 'green', pch = '+')
lines(c(0, recall3[order(recall3)]),
c(0, precision3[order(precision3, decreasing = TRUE)]), col = 'green')
points(0, 0, col = 'blue', pch = 'x')
points(recall4, precision4, col = 'blue', pch = 'x')
lines(c(0, recall4[order(recall4)]),
c(0, precision4[order(precision4, decreasing = TRUE)]),
col = 'blue')
text(c(0, recall4), c(0, precision4), labels = c(0, 3, 6, 9), pos = 3)
legend(0.1, 0.075, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(1, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(0, 0, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
points(recall, precision)
lines(c(0, recall[order(recall)]), c(0, precision[order(precision, decreasing = TRUE)]))
points(0, 0, col = 'red', pch = 2)
points(recall2, precision2, col = 'red', pch = 2)
lines(c(0, recall2[order(recall2)]),
c(0, precision2[order(precision2, decreasing = TRUE)]), col = 'red')
points(0, 0, col = 'green', pch = '+')
points(recall3, precision3, col = 'green', pch = '+')
lines(c(0, recall3[order(recall3)]),
c(0, precision3[order(precision3, decreasing = TRUE)]), col = 'green')
points(0, 0, col = 'blue', pch = 'x')
points(recall4, precision4, col = 'blue', pch = 'x')
lines(c(0, recall4[order(recall4)]),
c(0, precision4[order(precision4, decreasing = TRUE)]), col = 'blue')
text(c(0, recall4), c(0, precision4), labels = c(0, 3, 6, 9), pos = 3)
legend(0.09, 0.075, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(1, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
plot(recall, precision, ylim = c(0, 0.15), xlim = c(0, 0.18), asp = 1,
ylab = 'precision', xlab = 'recall', main = 'Precision-Recall (non-personalized)',
bty = 'l')
lines(recall[order(recall)], precision[order(precision, decreasing = TRUE)])
points(recall2, precision2, col = 'red', pch = 2)
lines(recall2[order(recall2)],
precision2[order(precision2, decreasing = TRUE)], col = 'red')
points(recall3, precision3, col = 'green', pch = '+')
lines(recall3[order(recall3)],
precision3[order(precision3, decreasing = TRUE)], col = 'green')
points(recall4, precision4, col = 'blue', pch = 'x')
lines(recall4[order(recall4)],
precision4[order(precision4, decreasing = TRUE)], col = 'blue')
text(recall4, precision4, labels = c(3, 6, 9), pos = 3)
legend(0, 0.075, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_cos', 'IBCF_cor',
'IBCF_std_cos'),
lty = 1, pch = c(1, 2, 3, 4), col = c('black', 'red', 'green', 'blue'))
list_results <- evaluate(x = eval_sets, method = models_to_evaluate,
n = n_recommendations)
setwd("F:/IMBA/4th semester/1-business analytics using statistical modeling/business_analytics_using_statistical_modeling")
library(openxlsx)
sec_qs <- read.xlsx('../13-security_questions.xlsx', sheet = 'data')
sec_qs_pca <- prcomp(sec_qs, scale. = TRUE)
screeplot(sec_qs_pca, type = 'l', main = 'Scree Plot of Security Questions')
View(sec_qs)
screeplot(sec_qs_pca, type = 'l', npcs = 18, main = 'Scree Plot of Security Questions')
eigen(cor(sec_qs), 2)
eigen(cor(sec_qs), 2)$values
sim_noise <- function(n, p) {
noise <- data.frame(replicate(p, rnorm(n)))
return(eigen(cor(noise))$values)
}
set.seed(0)
evalues_noise <- replicate(100, sim_noise(33, 10))
set.seed(0)
evalues_noise <- replicate(10000, sim_noise(33, 10))
evalues_mean <- apply(evalues_noise, 1, mean)
screeplot(sec_qs_pca, type = 'l', npcs = 18, main = 'Eigenvalues: seq_qs vs. noise')
lines(evalues_mean, col = 'red')
screeplot(sec_qs_pca, type = 'l', npcs = 18, main = 'Eigenvalues: seq_qs vs. noise')
lines(evalues_mean, type = 'b', col = 'red')
nrow(sec_qs)
ncol(sec_qs)
set.seed(0)
evalues_noise <- replicate(10000, sim_noise(nrow(sec_qs), ncol(sec_qs)))
evalues_mean <- apply(evalues_noise, 1, mean)
screeplot(sec_qs_pca, type = 'l', npcs = 18, main = 'Eigenvalues: seq_qs vs. noise')
lines(evalues_mean, type = 'b', col = 'red')
abline(h = 1, lty = 2)
library(psych)
sec_qs_principal <- principal(sec_qs, nfactor = 18, rotate = 'none', scores = TRUE)
sec_qs_principal$loadings
sec_qs_principal$loadings[, 1]
loadings <- sec_qs_principal$loadings
loadings[, 1][abs(loadings) > 0.7]
loadings[, 2][abs(loadings) > 0.7]
loadings[, 1][abs(loadings[, 1]) > 0.7]
loadings[, 2][abs(loadings[, 2]) > 0.7]
loadings[, 3][abs(loadings[, 3]) > 0.7]
sec_qs_principal$Vaccounted
sec_qs_principal$Vaccounted[3, 3]
paste(sec_qs_principal$Vaccounted[3, 3] * 100, '%', sep = '')
paste(round(sec_qs_principal$Vaccounted[3, 3] * 100, 2), '%', sep = '')
principal(sec_qs, nfactors = 3, rotate = 'none', scores = TRUE)
sec_qs_pca_ori <- principal(sec_qs, nfactors = 3, rotate = 'none', scores = TRUE)
sec_qs_pca_ori$values
sec_qs_pca_ori$communality
which.min(sec_qs_pca_ori$communality)
min(sec_qs_pca_ori$communality)
which.min(sec_qs_pca_ori$communality)
names(which.min(sec_qs_pca_ori$communality))
sec_qs_pca_ori
loadings3 <- loadings[, 1:3]
loadings3
loadings3 <- round(loadings[, 1:3], 1)
loadings3
loadings3 <- loadings[, 1:3]
loadings3
sim_loads <- function(x) {
return(abs(loadings[x, 1] - loadings[x, 2]) < 0.1 |
abs(loadings[x, 2] - loadings[x, 3]) < 0.1 |
abs(loadings[x, 1] - loadings[x, 3]) < 0.1)
}
sim_loads(1)
sim_loads(4)
sim_loads(17)
sim_loads(1:18)
loadings[, 1][abs(loadings[, 1]) > 0.7]
sec_qs_pca_ori$Vaccounted
sec_qs_pca_rot <- principal(sec_qs, nfactors = 3, rotate = 'varimax', scores = TRUE)
sec_qs_pca_ori$Vaccounted[4, ]
sec_qs_pca_rot$Vaccounted[4, ]
sec_qs_pca_ori$Vaccounted[3, ]
sec_qs_pca_rot$Vaccounted[3, ]
paste(round(sec_qs_pca_ori$Vaccounted[3, 3] * 100, 2), '%', sep = '')
paste(round(sec_qs_pca_rot$Vaccounted[3, 3] * 100, 2), '%', sep = '')
sim_loads <- function(loadings, x) {
return(abs(loadings[x, 1] - loadings[x, 2]) < 0.1 |
abs(loadings[x, 2] - loadings[x, 3]) < 0.1 |
abs(loadings[x, 1] - loadings[x, 3]) < 0.1)
}
sim_loads(loadings3, 1:18)
loadings_rot <- sec_qs_pca_rot$loadings
loadings_rot
loadings3
loadings_rot <- sec_qs_pca_rot$loadings[, 1:3]
loadings_rot
sim_loads(loadings_rot)
loadings_rot[c(4, 12, 17, 18), ]
0.2182880 + 0.1933627 + 0.8536838
loadings_ori[c(4, 12, 17, 18), ]
loadings_ori <- loadings[, 1:3]
loadings_ori[c(4, 12, 17, 18), ]
sim_loads <- function(loadings, x) {
return((abs(loadings[x, 1] - loadings[x, 2]) < 0.1 |
abs(loadings[x, 2] - loadings[x, 3]) < 0.1 |
abs(loadings[x, 1] - loadings[x, 3]) < 0.1) &
(loadings[x, ] > 0.7)
)
}
sim_loads(loadings_ori, 1:18)
sim_loads <- function(loadings, x) {
return((abs(loadings[x, 1] - loadings[x, 2]) < 0.1 |
abs(loadings[x, 2] - loadings[x, 3]) < 0.1 |
abs(loadings[x, 1] - loadings[x, 3]) < 0.1) &
(loadings[x, 1] > 0.7 | loadings[x, 2] > 0.7 | loadings[x, 3] > 0.7)
)
}
sim_loads(loadings_ori, 1:18)
loadings_ori
sim_loads <- function(loadings, x) {
return((abs(loadings[x, 1] - loadings[x, 2]) < 0.1 |
abs(loadings[x, 2] - loadings[x, 3]) < 0.1 |
abs(loadings[x, 1] - loadings[x, 3]) < 0.1) &
(loadings[x, 1] < 0.7 | loadings[x, 2] < 0.7 | loadings[x, 3] < 0.7)
)
}
sim_loads(loadings_ori, 1:18)
sim_loads <- function(loadings, x) {
return((abs(loadings[x, 1] - loadings[x, 2]) < 0.1 |
abs(loadings[x, 2] - loadings[x, 3]) < 0.1 |
abs(loadings[x, 1] - loadings[x, 3]) < 0.1) &
(loadings[x, 1] < 0.7 & loadings[x, 2] < 0.7 & loadings[x, 3] < 0.7)
)
}
sim_loads(loadings_ori, 1:18)
loadings_ori
loadings_ori[c(4, 12, 17), ]
loadings_rot[c(4, 12, 17), ]
sim_loads(loadings_rot)
loadings_rot[, 1][abs(loadings_rot[, 1]) > 0.7]
loadings_rot[, 1][abs(loadings_rot[, 1]) > 0.7]
loadings_rot[, 2][abs(loadings_rot[, 2]) > 0.7]
loadings_rot[, 3][abs(loadings_rot[, 3]) > 0.7]
sec_qs_pca_rot2 <- principal(sec_qs, nfactors = 2, rotate = 'varimax', scores = TRUE)
loadings_rot2 <- sec_qs_pca_rot2$loadings[, 1:2]
loadings_rot2[, 1][abs(loadings_rot2[, 1]) > 0.7]
loadings_rot2[, 2][abs(loadings_rot2[, 2]) > 0.7]
loadings_rot2
par(pty = 's')
plot(list_results, annotate = 1, legend = 'topleft', xlim = c(0, 0.1))
plot(list_results, annotate = 1, legend = 'bottomright', xlim = c(0, 0.1))
plot(list_results, annotate = 1, legend = c(0.07, 0.04), xlim = c(0, 0.1))
legend(0.07, 0.04, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_std_cos', 'IBCF_cos',
'IBCF_cor'), lty = 1, pch = c(1:4),
col = c('black', 'red', 'green', 'blue'))
plot(list_results, annotate = 1, xlim = c(0, 0.1))
legend(0.05, 0.06, bty = 'n', legend = c('IBCF_adj_cos', 'IBCF_std_cos', 'IBCF_cos',
'IBCF_cor'), lty = 1, pch = c(1:4),
col = c('black', 'red', 'green', 'blue'))
plot(list_results, annotate = 1, xlim = c(0, 0.1), legend = 'n')
plot(list_results, annotate = 1, xlim = c(0, 0.1))
plot(list_results, annotate = 1, xlim = c(0, 0.1), legend = 'bottomright')
plot(list_results, annotate = 1, xlim = c(0, 0.1), legend = 'bottom')
plot(list_results, annotate = 1, xlim = c(0, 0.1), legend = 'right')
plot(list_results, annotate = 1, xlim = c(0, 0.1), legend = 'topright')
plot(list_results, annotate = 1, xlim = c(0, 0.1), legend = 'topleft')
plot(list_results, annotate = 1, xlim = c(0, 0.1), legend = 'topright')
plot(list_results, 'prec/rec', annotate = 1, legend = 'bottomright')
